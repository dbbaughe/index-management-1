
PUT localhost:9200/_opendistro/_ism/policies/example
Content-Type: application/json

{
  "policy": {
    "description": "ingesting logs",
    "default_state": "ingest",
    "states": [
      {
        "name": "ingest",
        "actions": [
          {
            "rollover": {
              "min_doc_count": 5
            }
          }
        ],
        "transitions": [
          {
            "state_name": "search"
          }
        ]
      },
      {
        "name": "search",
        "actions": [],
        "transitions": [
          {
            "state_name": "delete",
            "conditions": {
              "min_index_age": "5m"
            }
          }
        ]
      },
      {
        "name": "delete",
        "actions": [
          {
            "delete": {}
          }
        ],
        "transitions": []
      }
    ]
  }
}

###

PUT localhost:9200/_opendistro/_ism/policies/test
Content-Type: application/json

{
  "policy": {
    "description": "ingesting logs",
    "default_state": "ingest",
    "states": [
      {
        "name": "ingest",
        "actions": [],
        "transitions": [
          {
            "state_name": "search"
          }
        ]
      },
      {
        "name": "search",
        "actions": [],
        "transitions": [
          {
            "state_name": "ingest"
          }
        ]
      }
    ]
  }
}

###

PUT localhost:9200/test-index
Content-Type: application/json

###

POST localhost:9200/_plugins/_ism/add/test-index
Content-Type: application/json

{
  "policy_id": "test"
}

###

GET localhost:9200/_plugins/_ism/explain/test-index
Content-Type: application/json

###

GET localhost:9200/_plugins/_ism/execute/test-index
Content-Type: application/json